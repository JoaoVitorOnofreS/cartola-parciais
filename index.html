<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Top Jogadores - Cartola FC</title>
  <style>
    body {
      font-family: Arial, sans-serif;
  background-color: #0f0f0f;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #ffffff;
    }
    .jogadores {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
    .card {
  display: flex;
  flex-direction: column;
  align-items: center;
  background: #1e1e1e;
  border-radius: 8px;
  padding: 16px;
  margin: 10px;
  width: 160px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
  color: white;
}

.nome {
  font-weight: bold;
  font-size: 16px;
  margin-bottom: 8px;
}

.pontos {
  font-size: 14px;
  margin-bottom: 8px;
}

.emblema {
  width: 60px;
  height: 60px;
  object-fit: contain;
}

.positivos {
  color: #4CAF50;
  background-color: rgba(76, 175, 80, 0.2);
  padding: 4px 8px;
  border-radius: 4px;
}

.negativos {
  color: #F44336;
  background-color: rgba(244, 67, 54, 0.2);
  padding: 4px 8px;
  border-radius: 4px;
}
  </style>
</head>
<body>
  <h1>Top Jogadores - Rodada <span id="rodada"></span></h1>

    <!-- Filtros -->
  <div style="text-align: center; margin-bottom: 20px;">
    <input type="text" id="filtroNome" placeholder="Buscar por nome" style="padding: 6px; width: 60%; max-width: 250px;" />
    <select id="filtroTime" style="padding: 6px; margin-left: 10px;">
      <option value="">Todos os times</option>
    </select>
    <div style="margin-top: 10px;">
      <button onclick="aplicarFiltro('todos')">Todos</button>
      <button onclick="aplicarFiltro('positivos')">Positivos</button>
      <button onclick="aplicarFiltro('negativos')">Negativos</button>
    </div>
  </div>

    <div class="jogadores" id="jogadores"></div>



  <script>
     const times = [
  { id: 1, nome: 'Flamengo', emblema: '/assets/fla.png', sigla: 'FLA' },
  { id: 2, nome: 'Fluminense', emblema: '/assets/flu.png', sigla: 'FLU' },
  { id: 3, nome: 'Botafogo', emblema: '/assets/bot.png', sigla: 'BOT' },
  { id: 4, nome: 'Palmeiras', emblema: '/assets/pal.png', sigla: 'PAL' },
  { id: 5, nome: 'Santos', emblema: '/assets/san.png', sigla: 'SAN' },
  { id: 6, nome: 'São Paulo', emblema: '/assets/sao.png', sigla: 'SAO' },
  { id: 7, nome: 'Corinthians', emblema: '/assets/cor.png', sigla: 'COR' },
  { id: 8, nome: 'Grêmio', emblema: '/assets/gre.png', sigla: 'GRE' },
  { id: 9, nome: 'Internacional', emblema: '/assets/int.png', sigla: 'INT' },
  { id: 10, nome: 'Atlético Mineiro', emblema: '/assets/cam.png', sigla: 'CAM' },
  { id: 11, nome: 'Cruzeiro', emblema: '/assets/cru.png', sigla: 'CRU' },
  { id: 12, nome: 'Bahia', emblema: '/assets/bai.png', sigla: 'BAH' },
  { id: 13, nome: 'Sport', emblema: '/assets/spt.png', sigla: 'SPT' },
  { id: 14, nome: 'Vasco', emblema: '/assets/vas.png', sigla: 'VAS' },
  { id: 15, nome: 'Fortaleza', emblema: '/assets/for.png', sigla: 'FOR' },
  { id: 16, nome: 'Ceará', emblema: '/assets/cea.png', sigla: 'CEA' },
  { id: 17, nome: 'Vitória', emblema: '/assets/vit.png', sigla: 'VIT' },
  { id: 18, nome: 'Mirassol', emblema: '/assets/mir.png', sigla: 'MIR' },
  { id: 19, nome: 'Red Bull Bragantino', emblema: '/assets/rbb.png', sigla: 'RBB' },
  { id: 20, nome: 'Juventude', emblema: '/assets/juv.png', sigla: 'JUV' }
];

    let jogadoresArrayGlobal = [];
    let filtroPontuacao = 'todos';

    function aplicarFiltro(tipo) {
      filtroPontuacao = tipo;
      renderizarJogadores();
    }

    function getEmblema(urlFoto) {
      const match = urlFoto.match(/silhuetas\/(\w{3})\//);
      if (match) {
        const sigla = match[1];
        const time = times.find(t => t.sigla === sigla);
        if (time) return time.emblema;
      }
      return urlFoto;
    }

    function classificarPontos(pontos, div) {
      if (pontos > 0) {
        div.classList.add('positivos');
      } else {
        div.classList.add('negativos');
      }
    }

    function renderizarJogadores() {
      const jogadores = document.getElementById('jogadores');
      jogadores.innerHTML = '';

      const nomeBusca = document.getElementById('filtroNome').value.toLowerCase();
      const timeSelecionado = document.getElementById('filtroTime').value;

      const filtrados = jogadoresArrayGlobal.filter(jogador => {
        const atendePontuacao =
          filtroPontuacao === 'todos' ||
          (filtroPontuacao === 'positivos' && jogador.pontuacao > 0) ||
          (filtroPontuacao === 'negativos' && jogador.pontuacao < 0);

        const atendeNome = jogador.apelido.toLowerCase().includes(nomeBusca);
        const atendeTime =
          !timeSelecionado || jogador.foto.includes(`/${timeSelecionado}/`);

        return atendePontuacao && atendeNome && atendeTime;
      });

      filtrados.forEach(jogador => {
        const card = document.createElement('div');
        const emblema = getEmblema(jogador.foto);
        const pontuacao = jogador.pontuacao;

        card.classList.add('card');
        card.innerHTML = `
          <div class="nome">${jogador.apelido}</div>
          <div class="pontos">${pontuacao}</div>
          <img class="emblema" src="${emblema}" alt="${jogador.apelido}">
        `;
        jogadores.appendChild(card);

        const pontosDiv = card.querySelector('.pontos');
        classificarPontos(pontuacao, pontosDiv);
      });
    }

   async function buscarJogadores() {
  try {
    const response = await fetch('https://api.allorigins.win/get?url=' + encodeURIComponent('https://api.cartola.globo.com/atletas/pontuados'));
    const data = await response.json();
    const cartolaData = JSON.parse(data.contents); // aqui está a mágica

    document.getElementById('rodada').textContent = cartolaData.rodada;

    jogadoresArrayGlobal = Object.values(cartolaData.atletas);
    jogadoresArrayGlobal.sort((a, b) => b.pontuacao - a.pontuacao);

    renderizarJogadores();
    popularTimesNoFiltro();
  } catch (error) {
    console.error(error);
  }
}

    function popularTimesNoFiltro() {
      const select = document.getElementById('filtroTime');
      times.forEach(t => {
        const option = document.createElement('option');
        option.value = t.sigla;
        option.textContent = t.nome;
        select.appendChild(option);
      });
    }

    document.getElementById('filtroNome').addEventListener('input', renderizarJogadores);
    document.getElementById('filtroTime').addEventListener('change', renderizarJogadores);

    buscarJogadores();
  </script>
</body>

    


   